<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="../../../Assets/assets_dashboard/logoUPFINITY.png" />
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <link rel="stylesheet" href="dashSeguranca.css">
    <title>Segurança Upfinity</title>
</head>

<body>
    <section id="dashSeguranca">

        <div id="esquerda">
            <div id="esquerda-cima">
                <img src="../../../Assets/assets_dashboard/logoUPFINITY.png" id="logo-upfinity" alt="logo-upfinity">
            </div>
            <div id="esquerda-centro">
                <div id="navegacao">
                    <h1 onclick="window.location = '../../visaoGeral/visaoGeral.html'">VISÃO GERAL</h1>
                    <div class="linha"></div>
                    <h1 onclick="window.location = '../../dashboard/dashboard.html'">DASHBOARDS</h1>
                    <div class="linha"></div>
                    <h1 onclick="validarRedirecionamento('../../gestaoUsuarios/gestaoUsuarios.html')">GESTÃO DE USUÁRIOS
                    </h1>
                    <div class="linha"></div>
                    <h1 onclick="validarRedirecionamento('../../gestaoATM/gestaoATM.html')">GESTÃO DE ATMS</h1>
                    <div class="linha"></div>
                </div>
            </div>
            <div id="esquerda-baixo">
                <div id="navegacaoSair">
                    <div class="linha"></div>
                    <div id="btSair">
                        <h1>SAIR</h1>
                        <img src="../../../Assets/assets_dashboard/SAIRICON.png" alt="logoSaída">
                    </div>
                </div>
            </div>
        </div>

        <div id="direita">

            <div id="direita-cima">
                <h1 id="titulo-seguranca">SEGURANÇA DO ATM - </h1>
                <select id="comboATMs" onchange="mudarATM()">
                    <option value="">ATM 1</option>
                </select>
            </div>
            <div id="direita-baixo">
                <div id="centro-seguranca">
                    <div id="informacoes">
                        <div id="KPIS">
                            <div class="kpi">
                                <div class="box-titulo-kpi">
                                    <h1 class="titulo-kpi">Estado atual do ATM</h1>
                                </div>
                                <div class="box-valor-kpi">
                                    <h1 id="valor_kpi_seguranca" style="font-size: 2vw;" class="valor-kpi"></h1>
                                </div>
                                <div class="box-informativo"></div>
                            </div>
                            <div class="kpi_dupla">

                                <div class="caixa-kpi-dupla">
                                <div class="box-titulo-kpi">
                                    <h1 class="titulo-kpi">Conexões abertas</h1>
                                </div>
                                <div class="box-valor-kpi">
                                    <h1 id="valor_kpi_porta" class="valor-kpi"></h1>
                                </div>
                                <div onclick="dialog_portas.showModal()" class="box-informativo"></div>
                            </div>

                            <div class="linha_vertical"></div>

                            <div class="caixa-kpi-dupla">
                                <div class="box-titulo-kpi">
                                    <h1 class="titulo-kpi">Conexões Suspeitas</h1>
                                </div>
                                <div class="box-valor-kpi">
                                    <h1 id="valor_kpi_conexoes" class="valor-kpi"></h1>
                                </div>
                                <div class="box-informativo">
                                    <img onclick="dialog_conexao.showModal()" class="informativo" src="../../../Assets/assets_dashboard/iconeInformativo.png">
                                </div>
                            </div>

                            </div>

                            <div class="kpi">
                                <div class="box-titulo-kpi">
                                    <h1 class="titulo-kpi">Logins malsucedidos da última semana</h1>
                                </div>
                                <div class="box-valor-kpi">
                                    <h1 id="valor_kpi_invasao" class="valor-kpi"></h1>
                                </div>
                            </div>
                        </div>


                        <div id="conteudo">
                            <div id="arquivos">
                                <div id="caixa_arquivos">
                                    <div id="titulo_arquivos">
                                        <h1 id="titulo-arquivos-criticos">Arquivos Críticos</h1>
                                        <div class="linha_caixas"></div>
                                    </div>
                                    <div id="lista_arquivos"></div>
                                </div>
                            </div>
                            <div id="grafico">
                                <div id="caixa_grafico">
                                    <div id="titulo_grafico">
                                        <h1 id="titulo_grafico_linha">Alertas por semana nos últimos 2 meses</h1>
                                    </div>
                                    <div id="graficoLinha"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="listas">
                        <div id="conexoes">
                            <div id="caixa_conexoes">
                                <div id="titulo_conexoes">
                                    <h1 id="titulo-conexoes-abertas">Tentativas de Login</h1>
                                    <div class="linha_caixas"></div>
                                </div>
                                <div id="lista_conexoes"></div>
                            </div>
                        </div>
                        <div id="alertas">
                            <div id="caixa_alertas">
                                <div id="titulo_alertas">
                                    <h1 id="titulo-historico-alertas">Histórico de Alertas</h1>
                                    <div class="linha_caixas"></div>
                                </div>
                                <div id="lista_alertas"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <div id="upstuart">
        </div>

        <dialog id="dialog_conexao">
            <div id="titulo_dialog_conexao">
                <h1 id="titulo-conexao">Conexões suspeitas:</h1>
                <div class="linha_caixas"></div>
            </div>
            <div id="baixo-dialog-conexao">
                <div id="caixa-tabela-scrolavel">
                    <table id="tabela_conexoes"></table>
                </div>
                <button onclick="fecharDialog()" class="botao_fechar_dialog">Fechar</button>
            </div>
        </dialog>

        <dialog id="dialog_arquivos">
            <div id="titulo_dialog_arquivos">
                <h1 id="titulo-arquivos">Declarar alteração como segura</h1>
                <div class="linha_caixas"></div>
            </div>
            <div id="baixo-dialog-arquivos">
                <h1 id="pergunta-dialog-arquivos">O conteúdo do seu arquivo foi alterado, a alteração é segura?</h1>
                <button onclick="declararSeguro()" class="botoes_arquivos">Sim! Eu reconheço a alteração</button>
                <button onclick="fecharDialog()" class="botoes_arquivos">Fechar</button>
            </div>
        </dialog>

    </section>
</body>

</html>

<script>
    
    function fecharDialog() {
        dialog_conexao.close()
        dialog_arquivos.close()
    }
    
    function validarRedirecionamento(endpoint) {
        if (sessionStorage.FK_TIPOUSUARIO == 3) {
            alerta_erros_desktop.classList.remove('d-none')
            span_erro_desktop.innerText = 'Você não tem permissão para entrar nessa página'
            return;
        }

        window.location = `${endpoint}`
    }
</script>

<script src="dashSeguranca.js"></script>